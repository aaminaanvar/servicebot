(this["webpackJsonprasa-frontend"]=this["webpackJsonprasa-frontend"]||[]).push([[6],{2189:function(e,r,t){"use strict";t.r(r);var n=t(2),l=t(0),o=t(1),a=t(14),s=t(237),c=t(4),u=t(2064),i=t(3),d=t(18),f=t(79),j=t(2022),b=t(543),h=t(2053),x=t(542),v=t(2025),O=t(62),w=t(33),m=t(12),y=t(493),R=t(234);function p(e){return null!==e}function k(e){var r=e.onDelete,t=e.onLoadMoreRows,n=e.onSaveUserRoles,a=e.onSearch,s=e.roles,c=e.searchQuery,u=e.total,d=e.unfilteredTotal,k=e.users,D=o.useCallback((function(e,r){return Object(l.jsx)(y.a,{p:4,name:"Roles",items:s.map((function(e){return e.role})),checkedItems:e.filter((function(e){return"role"===e.keyword})).map((function(e){return e.value})),onChange:function(t){return r(e.filter((function(e){return"role"!==e.keyword})).concat(t.map((function(e){return{keyword:"role",value:e,negated:!1}}))))}})}),[s]),S=o.useMemo((function(){return{keyword:"role",values:s.map((function(e){return{label:e.role,total:e.users_count||0}})),clear:!0,all:"All",total:d}}),[s,d]),C=o.useCallback((function(e){var r=e.selected,t=e.onChangeSelected;return function(e){var n=e.rowIndex,o=e.rowData;if(!o)return null;var a=r.includes(n);return Object(l.jsxs)(i.Flex,{alignItems:"center",children:[Object(l.jsx)(i.Box,{flex:"0 1 auto",mr:3,children:Object(l.jsx)("label",{children:Object(l.jsx)(v.a,{checked:a,onChange:function(){return t(n,!a)}})})}),Object(l.jsx)(i.Box,{flex:"1",style:{overflow:"hidden",textOverflow:"ellipsis"},children:Object(l.jsx)(b.a,{variant:"bodySecondary",children:o.username})})]})}}),[]),T=function(e){var r=e.rowData,t=e.rowIndex,o=r;if(!o)return null;var a=s.map((function(e){return{label:e.role,value:e.role,data:e}})),c=s.reduce((function(e,r){return e[r.role]=r,e}),{}),u=o.roles.map((function(e){var r=c[e];return r?{label:r.role,value:r.role,data:r}:null})).filter(p);return Object(l.jsx)(h.a,{placeholder:"Search roles...",fullWidth:!0,items:a,onChange:function(e){Array.isArray(e)&&n({userIndex:t,user:o,roles:e.map((function(e){return e.data}))})},value:u})},U=function(e){var t=e.rowData;return t?Object(l.jsx)(i.Flex,{flexDirection:"row-reverse",mr:-1,children:Object(l.jsx)(w.a,{resource:m.d.Users,action:m.a.Delete,yes:Object(l.jsx)(j.a,{mr:1,variant:"icon",onClick:function(){r([t])},children:Object(l.jsx)(x.a,{icon:f.faTrashAlt})})})}):null};return Object(l.jsx)(R.a,{bulkActionsRenderer:function(e){var t=e.dataSelected,n=e.setSelected;return Object(l.jsx)(w.a,{resource:m.d.Users,action:m.a.Delete,yes:Object(l.jsx)(j.a,{onClick:function(){r(t),n([])},variant:"inverse",children:"Delete"})})},data:k,filtersRenderer:D,quickFilters:S,onLoadMoreRows:t,onSearch:a,resource:m.d.User,searchQuery:c,total:u,children:function(e){return[Object(l.jsx)(O.d,{cellDataGetter:function(){},flexGrow:2,width:300,dataKey:"username",label:"User",className:"ReactVirtualized__Table__rowColumn_overflow",cellRenderer:C(e)},"model"),Object(l.jsx)(O.d,{cellDataGetter:function(){},flexGrow:3,width:450,dataKey:"roles",label:"Roles",cellRenderer:T},"type"),Object(l.jsx)(O.d,{cellDataGetter:function(){},flexGrow:1,width:150,dataKey:"username",className:"ReactVirtualized__Table__rowColumnOnHover",label:"",cellRenderer:U},"actions")]}})}function D(e){var r=e.onDelete,t=e.onFetchRoles,n=e.onFetchUsers,a=e.onLoadMoreRows,s=e.onSaveUserRoles,c=e.roles,f=e.searchQuery,j=e.total,b=e.users,h=e.unfilteredTotal,x=Object(d.k)();o.useEffect((function(){x("view:users:loaded")}),[x]),o.useEffect((function(){t({search:"",offset:0,limit:0}),n({search:f,offset:0,limit:20})}),[t,n,f]);var v=o.useCallback((function(e){return n({search:e,offset:0,limit:20})}),[n]),O=Object.values(c);return Object(l.jsx)(u.a,{title:"Users",children:Object(l.jsx)(i.Flex,{flexDirection:"column",style:{height:"100%"},children:Object(l.jsx)(i.Box,{flex:"1",children:Object(l.jsx)(k,{roles:O,total:j,users:b,unfilteredTotal:h,onDelete:r,onLoadMoreRows:a,onSearch:v,searchQuery:f,onSaveUserRoles:s})})})})}var S=t(72),C=t(149),T=t(50),U={onFetchUsers:T.c.request,onDelete:T.a.request,onFetchRoles:S.d.request,onSaveUserRoles:T.e.request};r.default=Object(a.b)((function(e){return{users:e.users.users,total:e.users.total,searchQuery:e.users.searchQuery,roles:e.roles.roles,unfilteredTotal:e.users.unfilteredTotal}}),U)((function(e){return Object(l.jsx)(s.a,{listener:C.b,start:Object(c.getType)(T.c.request),resolve:Object(c.getType)(T.c.success),reject:Object(c.getType)(T.c.failure),children:function(r){return Object(l.jsx)(D,Object(n.a)(Object(n.a)({},e),{},{onLoadMoreRows:r}))}})}))}}]);